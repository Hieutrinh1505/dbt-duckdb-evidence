WITH raw_zip AS
(
    SELECT DISTINCT zipcode 
    FROM {{ref('raw_crime')}}
)

----ZIPCODE referring to https://www.houstonproperties.com/houston-neighborhoods/houston-zip-code-map
SELECT 
    zipcode, 
    CASE 
        WHEN zipcode IN 
        (
            77002, 77003, 77004, 77005, 770063, 77007, 77008, 77009, 77010, 77011, 77018,
            77019, 77021, 77022, 77023, 77024, 77025, 77030, 77045, 77054, 77056, 77057, 77076,
            77081, 77088, 77091, 77096, 77098, 77204, 77401, 77037, 77038, 77046, 77052
        ) THEN 'CENTRAL HOUSTON'
        
        WHEN zipcode IN 
        (
            77007, 77042, 77074, 77094, 77478, 77018, 77043, 77077, 77099, 77479, 77024, 
            77053, 77079, 77406, 77489, 77027, 77055, 77080, 77407, 77493, 77031, 77056, 
            77082, 77449, 77494, 77035, 77057, 77083, 77450, 77498, 77036, 77063, 77084, 
            77459, 77477, 77040, 77071, 77085, 77469, 77497, 77041, 77072, 77092, 77472, 
            77492            
        ) THEN 'WEST/SOUTHWEST'
        
        WHEN zipcode IN 
        (
            77014, 77066, 77095, 77377, 77389, 77018, 77067, 77325, 77379, 77396, 
            77032, 77068, 77338, 77380, 77429, 77039, 77069, 77339, 77381, 77433, 
            77040, 77070, 77345, 77382, 77447, 77050, 77073, 77346, 77384, 77484, 
            77060, 77086, 77354, 77385, 77064, 77090, 77373, 77386, 77065, 77093, 77375, 
            77388
        ) THEN 'NORTH/NORTHWEST'
        
        WHEN zipcode IN 
        (
            77012, 77029, 77357, 77013, 77044, 77365, 77015, 77049, 77520, 77016, 
            77078, 77530, 77020, 77336, 77536, 77026, 77338, 77547, 77028, 77346, 
            77571
        ) THEN 'EAST/NORTHEAST'
        
        WHEN zipcode IN 
        (
            77015, 77058, 77459, 77546, 77587, 77017, 77059, 77502, 77573, 77588, 
            77033, 77061, 77503, 77574, 77598, 77034, 77062, 77504, 77578, 77532, 
            77047, 77075, 77505, 77581, 77048, 77087, 77506, 77584, 77051, 77089, 
            77507, 77586
        ) THEN 'SOUTH/SOUTHEAST'
        
        WHEN zipcode IN 
        (
            77094, 77449, 77450, 77493, 77494, 77492
        ) THEN 'KATY' 
        
        ELSE 'OTHER' 
    END AS area
FROM raw_zip
